<html style="direction: rtl">

<head>
    <script src="https://unpkg.com/vue@2.5.13/dist/vue.min.js"></script>
    <script src="https://unpkg.com/bootstrap-vue@2.0.0-rc.1/dist/bootstrap-vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.min.js"></script>

    <link rel="stylesheet" href="https://unpkg.com/bootstrap@4.1.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-vue@2.0.0-rc.1/dist/bootstrap-vue.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.css"/>

    <style>
        * {
            direction: rtl;
            text-align: right;
        }

        labels {
            text-align: left;
        }
    </style>

</head>

<body>
<div class="container">
    <h1 class="mt-5 mb-5">מחשבון פנסיה</h1>

    <div id='app'>

        <div class="row">
            <div class="col-sm-6">
                <div class="form-group row">
                    <label for="age" class="col-sm-6 col-form-label">גיל</label>
                    <div class="col-sm-6">
                        <input id="age" type="number" v-model="age">
                    </div>
                </div>


                <div class="form-group row">
                    <label for="salary" class="col-sm-6 col-form-label">משכורת חודשית בשקלים</label>
                    <div class="col-sm-6">
                        <input id="salary" type="number" v-model="salary">
                    </div>
                </div>
            </div>
            <div class="col-sm-6">

                <div class="form-group row">
                    <div class="col-sm-12">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="topsalary" v-model="topsalary">
                            <label class="form-check-label" for="topsalary">&nbsp; &nbsp; &nbsp;
                                המעסיק מפריש לפנסיה עד גובה השכר?
                            </label>
                        </div>
                    </div>
                </div>


                <div class="form-group row">
                    <div class="col-sm-12">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="employer_aka" v-model="employer_aka">
                            <label class="form-check-label" for="employer_aka">&nbsp; &nbsp; &nbsp;
                                המעסיק משלם ביטוח אובדן כושר עבודה בנפרד?
                            </label>
                        </div>
                    </div>
                </div>

                <div class="form-group row">
                    <div class="col-sm-12">

                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="children" v-model="children">
                            <label class="form-check-label" for="children">&nbsp; &nbsp; &nbsp;
                                האם יש ילדים?
                            </label>
                        </div>
                    </div>
                </div>

                <div class="form-group row">
                    <div class="col-sm-12">

                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="life" v-model="life">
                            <label class="form-check-label" for="life">&nbsp; &nbsp; &nbsp;
                                מעוניין בביטוח חיים?
                            </label>
                        </div>
                    </div>
                </div>

                <div class="form-group row">
                    <div class="col-sm-12">

                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="specific" v-model="specific">
                            <label class="form-check-label" for="specific">&nbsp; &nbsp; &nbsp;
                                מעוניין בביטוח אובדן כושר עבודה עבור המקצוע הנוכחי הספציפי, או עבור כל מקצוע שבו האדם יוכל לתפקד בו
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-5" style="background-color: #ffeeee">
            <div class="col">
                <h2>תוכנית נוכחית</h2>
                <hr/>

            </div>
        </div>
        <div class="row" style="background-color: #ffeeee">
            <div class="col-sm-6">
                <h4>קרן פנסיה</h4>
                <p>מומלץ להפקיד אל קרן פנסיה מאחר והביטוח מאוד זול.</p>
                <div class="form-group row">
                    <label for="pension_initial_funds_1" class="col-sm-6 col-form-label">סכום כסף נוכחי</label>
                    <div class="col-sm-6">
                        <input id="pension_initial_funds_1" type="number" v-model="pension_initial_funds_1">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="pension_fund_tzvira_1" class="col-sm-6 col-form-label">תשלום מהצבירה (%)</label>
                    <div class="col-sm-6">
                        <input class="form-check-input" id="pension_fund_tzvira_1" type="number" v-model="pension_fund_tzvira_1">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="pension_fund_deposit_1" class="col-sm-6 col-form-label">תשלום מההפקדה (%)</label>
                    <div class="col-sm-6">
                        <input class="form-check-input" id="pension_fund_deposit_1" type="number" v-model="pension_fund_deposit_1">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="pension_fund_yield_1" class="col-sm-6 col-form-label">תשואה שנתית ממוצעת</label>
                    <div class="col-sm-6">
                        <input class="form-check-input" id="pension_fund_yield_1" type="number" v-model="pension_fund_yield_1">
                    </div>
                </div>
            </div>
            <div class="col-sm-6">

                <h4>הפקדה פנסיונית מעבר לתקרת קרן הפנסיה</h4>
                <p>למשל: (ביטוח מנהלים, קופת גמל, קרן פנסיה משלימה)</p>
                <div class="form-group row">
                    <label for="above_initial_funds_1" class="col-sm-6 col-form-label">סכום כסף נוכחי</label>
                    <div class="col-sm-6">
                        <input id="above_initial_funds_1" type="number" v-model="above_initial_funds_1">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="above_fund_tzvira_1" class="col-sm-6 col-form-label">תשלום מהצבירה (%)</label>
                    <div class="col-sm-6">
                        <input class="form-check-input" id="above_fund_tzvira_1" type="number" v-model="above_fund_tzvira_1">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="above_fund_deposit_1" class="col-sm-6 col-form-label">תשלום מההפקדה (%)</label>
                    <div class="col-sm-6">
                        <input class="form-check-input" id="above_fund_deposit_1" type="number" v-model="above_fund_deposit_1">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="above_fund_yield_1" class="col-sm-6 col-form-label">תשואה שנתית ממוצעת</label>
                    <div class="col-sm-6">
                        <input class="form-check-input" id="above_fund_yield_1" type="number" v-model="above_fund_yield_1">
                    </div>
                </div>
            </div>
        </div>


        <div class="row mt-5" style="background-color: #eeeeff">
            <div class="col">
                <h2>תוכנית חדשה</h2>
                <hr/>

            </div>
        </div>
        <div class="row" style="background-color: #eeeeff">
            <div class="col-sm-6">
                <h4>קרן פנסיה</h4>
                <p>מומלץ להפקיד אל קרן פנסיה מאחר והביטוח מאוד זול.</p>
                <div class="form-group row">
                    <label for="pension_initial_funds_2" class="col-sm-6 col-form-label">סכום כסף נוכחי</label>
                    <div class="col-sm-6">
                        <input id="pension_initial_funds_2" type="number" v-model="pension_initial_funds_2">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="pension_fund_tzvira_2" class="col-sm-6 col-form-label">תשלום מהצבירה (%)</label>
                    <div class="col-sm-6">
                        <input class="form-check-input" id="pension_fund_tzvira_2" type="number" v-model="pension_fund_tzvira_2">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="pension_fund_deposit_2" class="col-sm-6 col-form-label">תשלום מההפקדה (%)</label>
                    <div class="col-sm-6">
                        <input class="form-check-input" id="pension_fund_deposit_2" type="number" v-model="pension_fund_deposit_2">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="pension_fund_yield_2" class="col-sm-6 col-form-label">תשואה שנתית ממוצעת</label>
                    <div class="col-sm-6">
                        <input class="form-check-input" id="pension_fund_yield_2" type="number" v-model="pension_fund_yield_2">
                    </div>
                </div>
            </div>
            <div class="col-sm-6">

                <h4>הפקדה פנסיונית מעבר לתקרת קרן הפנסיה</h4>
                <p>למשל: (ביטוח מנהלים, קופת גמל, קרן פנסיה משלימה)</p>
                <div class="form-group row">
                    <label for="above_initial_funds_2" class="col-sm-6 col-form-label">סכום כסף נוכחי</label>
                    <div class="col-sm-6">
                        <input id="above_initial_funds_2" type="number" v-model="above_initial_funds_2">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="above_fund_tzvira_2" class="col-sm-6 col-form-label">תשלום מהצבירה (%)</label>
                    <div class="col-sm-6">
                        <input class="form-check-input" id="above_fund_tzvira_2" type="number" v-model="above_fund_tzvira_2">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="above_fund_deposit_2" class="col-sm-6 col-form-label">תשלום מההפקדה (%)</label>
                    <div class="col-sm-6">
                        <input class="form-check-input" id="above_fund_deposit_2" type="number" v-model="above_fund_deposit_2">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="above_fund_yield_2" class="col-sm-6 col-form-label">תשואה שנתית ממוצעת</label>
                    <div class="col-sm-6">
                        <input class="form-check-input" id="above_fund_yield_2" type="number" v-model="above_fund_yield_2">
                    </div>
                </div>
            </div>
        </div>
    <div class="row mt-5 mb-5">
        <div class="col-6">
            <table class="table">
                <thead>
                    <tr>
                        <th>נתון מחושב</th>
                        <th>סכום</th>
                    </tr>
                </thead>
                <tbody>
                <tr>
                    <th>חיסכון שנתי בש״ח</th>
                    <td>{{ savingsPerYear.toLocaleString() }}</td>
                </tr>
                <tr>
                    <th>הפרש בש״ח</th>
                    <td>{{ totalDiff.toLocaleString() }}</td>
                </tr>
                <tr>
                    <th>הפקדה שנתית לקרן פנסיה</th>
                    <td>{{ pensionDeposit.toLocaleString() }}</td>
                </tr>
                <tr>
                    <th>הפקדה שנתית מעבר</th>
                    <td>{{ abovePensionDeposit.toLocaleString() }}</td>
                </tr>
                <tr>
                    <th>צבירה בקרן פנסיה נוכחית בגיל 67</th>
                    <td>{{ firstPensionFundTotal.toLocaleString() }}</td>
                </tr>
                <tr>
                    <th>צבירה מעבר נוכחית בגיל 67</th>
                    <td>{{ firstAboveFundTotal.toLocaleString() }}</td>
                </tr>
                <tr>
                    <th>צבירה בקרן פנסיה חדשה בגיל 67</th>
                    <td>{{ secondPensionFundTotal.toLocaleString() }}</td>
                </tr>
                <tr>
                    <th>צבירה מעבר חדשה בגיל 67</th>
                    <td>{{ secondAboveFundTotal.toLocaleString() }}</td>
                </tr>

                </tbody>
            </table>
        </div>
    </div>

    </div>
    <div class="row">
        <canvas id="canvas"></canvas>
    </div>


</div>

<script>
    var MONTHS = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
    var config = {
        type: 'line',
        data: {
            labels: [],
            datasets: [{
                label: 'תוכנית ראשונה',
                data: [],
                fill: false,
                backgroundColor: 'red',
                borderColor: 'red',
            }, {
                label: 'תוכנית שניה',
                data: [],
                fill: false,
                backgroundColor: 'blue',
                borderColor: 'blue',
            }]
        },
        options: {
            responsive: true,
            title: {
                display: true,
                text: 'השוואת חיסכון פנסיוני'
            },
            tooltips: {
                mode: 'index',
                intersect: false,
            },
            hover: {
                mode: 'nearest',
                intersect: true
            },
            scales: {
                xAxes: [{
                    display: true,
                    scaleLabel: {
                        display: true,
                        labelString: 'גיל'
                    }
                }],
                yAxes: [{
                    ticks: {
                        beginAtZero: true
                    },
                    display: true,
                    scaleLabel: {
                        display: true,
                        labelString: 'חיסכון'
                    }
                }]
            }
        }
    };

    window.onload = function () {
        var ctx = document.getElementById('canvas').getContext('2d');

        Chart.scaleService.updateScaleDefaults('linear', {
            ticks: {
                callback: function (tick) {
                    return '₪' + tick.toLocaleString();
                }
            }
        });
        Chart.defaults.global.tooltips.callbacks.label = function (tooltipItem, data) {
            var dataset = data.datasets[tooltipItem.datasetIndex];
            var datasetLabel = dataset.label || '';
            return datasetLabel + ": ₪" + dataset.data[tooltipItem.index].toLocaleString();
        };
        window.savings = new Chart(ctx, config);

        new Vue({
            el: '#app',
            data: {
                age: 30,
                children: false,
                salary: 30000,
                topsalary: true,
                employer_aka: true,
                life: false,
                specific: false,

                pension_initial_funds_1: 100000,
                pension_fund_tzvira_1: 0.1,
                pension_fund_deposit_1: 0,
                pension_fund_yield_1: 3,

                above_initial_funds_1: 100000,
                above_fund_tzvira_1: 1,
                above_fund_deposit_1: 1,
                above_fund_yield_1: 3,

                pension_initial_funds_2: 100000,
                pension_fund_tzvira_2: 0.1,
                pension_fund_deposit_2: 0,
                pension_fund_yield_2: 5,

                above_initial_funds_2: 100000,
                above_fund_tzvira_2: 0.3,
                above_fund_deposit_2: 0,
                above_fund_yield_2: 8,

                savingsPerYear: 0,
                totalDiff: 0,
                pensionDeposit: 0,
                abovePensionDeposit: 0,
                firstPensionFundTotal: 0,
                firstAboveFundTotal: 0,
                secondPensionFundTotal: 0,
                secondAboveFundTotal: 0,

            },
            mounted: function () {
                this.updateGraph();
            },
            methods: {
                updateGraph: function () {
                    let currentAge = this.age;
                    let firstPensionFund = this.pension_initial_funds_1;
                    let firstAboveFund = this.above_initial_funds_1;
                    let secondPensionFund = this.pension_initial_funds_2;
                    let secondAboveFund = this.above_initial_funds_2;
                    const firstGraph = [];
                    const secondGraph = [];
                    const labels = [];

                    const savingsPercent = .2083;
                    const maxYearlyPensionDeposit = 50544;
                    const savingsPerYear = savingsPercent * this.salary * 12;

                    if (savingsPerYear > maxYearlyPensionDeposit) {
                        this.pensionDeposit = maxYearlyPensionDeposit;
                        this.abovePensionDeposit = savingsPerYear - maxYearlyPensionDeposit;
                    } else {
                        this.pensionDeposit = savingsPerYear;
                        this.abovePensionDeposit = 0;
                    }

                    this.savingsPerYear = savingsPerYear;

                    while (currentAge <= 67) {

                        labels.push(currentAge);
                        firstGraph.push(firstPensionFund + firstAboveFund);
                        secondGraph.push(secondPensionFund + secondAboveFund);

                        firstPensionFund += this.pensionDeposit * ((100 - this.pension_fund_deposit_1) / 100);
                        firstPensionFund *= (100 + this.pension_fund_yield_1 - this.pension_fund_tzvira_1) / 100;

                        firstAboveFund += this.abovePensionDeposit * ((100 - this.above_fund_deposit_1) / 100);
                        firstAboveFund *= (100 + this.above_fund_yield_1 - this.above_fund_tzvira_1) / 100;

                        secondPensionFund += this.pensionDeposit * ((100 - this.pension_fund_deposit_2) / 100);
                        secondPensionFund *= (100 + this.pension_fund_yield_2 - this.pension_fund_tzvira_2) / 100;

                        secondAboveFund += this.abovePensionDeposit * ((100 - this.above_fund_deposit_2) / 100);
                        secondAboveFund *= (100 + this.above_fund_yield_2 - this.above_fund_tzvira_2) / 100;

                        currentAge += 1;

                    }

                    this.firstPensionFundTotal = firstPensionFund;
                    this.firstAboveFundTotal = firstAboveFund;
                    this.secondPensionFundTotal = secondPensionFund;
                    this.secondAboveFundTotal = secondAboveFund;

                    this.totalDiff = secondPensionFund + secondAboveFund - firstPensionFund - firstAboveFund;

                    savings.data.labels = labels;
                    savings.data.datasets[0].data = firstGraph;
                    savings.data.datasets[1].data = secondGraph;
                    savings.update();
                }
            },
            watch: {
                $data: {
                    handler: function () {
                        this.updateGraph();
                    },
                    deep: true
                }
            }
        });
    };


</script>

</body>

</html>
